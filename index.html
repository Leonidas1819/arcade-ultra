<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>El Trival</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
@import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

body{
    margin:0;
    background:black;
    color:#00ff66;
    font-family:'Press Start 2P', monospace;
    overflow:hidden;
}

/* ================= MEN√ö ================= */
#menu{
    height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
}

.menu-box{
    width:320px;
    text-align:center;
}

.menu-box h1{
    margin-bottom:20px;
}

.menu-box input{
    width:100%;
    box-sizing:border-box;
}

.menu-box button{
    width:100%;
    margin-top:12px;
}

#tabla{
    font-size:10px;
    margin-top:20px;
}

.instrucciones{
    margin-top:40px;
    font-size:9px;
    line-height:1.6;
    opacity:.9;
}

/* ================= JUEGO ================= */
#juego{
    display:none;
    text-align:center;
}

#hud{
    font-size:10px;
    padding:10px;
}

#pregunta{
    padding:10px;
}

/* ================= BOTONES ================= */
button,input{
    font-family:inherit;
    padding:10px;
    border:2px solid #00ff66;
    background:black;
    color:#00ff66;
}

button:hover{
    background:#00ff66;
    color:black;
}

.opcion{
    position:absolute;
    padding:10px 14px;
    border:2px solid #00ff66;
    cursor:pointer;
    user-select:none;
}

/* ================= PAUSA ================= */
#pausa{
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,.9);
    justify-content:center;
    align-items:center;
    flex-direction:column;
}

/* ================= FINAL ================= */
#final{
    display:none;
    height:100vh;
    justify-content:center;
    align-items:center;
    flex-direction:column;
    text-align:center;
}
</style>
</head>

<body>

<!-- MEN√ö -->
<div id="menu">
  <div class="menu-box">
    <h1>EL TRIVAL</h1>

    <input id="nombre" placeholder="JUGADOR">
    <button onclick="game.start()">‚ñ∂ INICIAR</button>

    <div id="tabla"></div>

    <div class="instrucciones">
      INSTRUCCIONES<br><br>
      ‚Ä¢ Toca la respuesta correcta<br>
      ‚Ä¢ No uses teclado<br>
      ‚Ä¢ ‚è±Ô∏è 10 segundos por pregunta<br>
      ‚Ä¢ ‚ù§Ô∏è 3 vidas<br>
      ‚Ä¢ ‚è∏ Pausa disponible
    </div>
  </div>
</div>

<!-- JUEGO -->
<div id="juego">
  <div id="hud">
    ‚ù§Ô∏è <span id="vidas">3</span> |
    ‚≠ê <span id="puntos">0</span> |
    ‚è±Ô∏è <span id="tiempo">10</span>
    <button onclick="game.togglePause()">‚è∏</button>
  </div>
  <h3 id="pregunta"></h3>
</div>

<!-- PAUSA -->
<div id="pausa">
  <h1>PAUSA</h1>
  <button onclick="game.togglePause()">‚ñ∂ CONTINUAR</button>
  <button onclick="game.backToMenu()">‚¨Ö MEN√ö</button>
</div>

<!-- FINAL -->
<div id="final">
  <h1 id="mensajeFinal"></h1>
  <button onclick="game.start()">‚Üª JUGAR OTRA VEZ</button>
  <button onclick="game.backToMenu()">‚¨Ö MEN√ö</button>
</div>

<script>
const $=id=>document.getElementById(id);

/* üîä Sonido retro */
const ctx=new (window.AudioContext||window.webkitAudioContext)();
function beep(f,d){
    const o=ctx.createOscillator(),g=ctx.createGain();
    o.frequency.value=f;
    o.connect(g); g.connect(ctx.destination);
    o.start();
    g.gain.exponentialRampToValueAtTime(.0001,ctx.currentTime+d);
    o.stop(ctx.currentTime+d);
}

/* üß† Preguntas */
function generarPreguntas(){
    const base=[
    ["Pa√≠s m√°s grande del mundo","Rusia",["Rusia","China","Canad√°","EE.UU"]],
        ["Capital de Jap√≥n","Tokio",["Tokio","Kioto","Se√∫l","Osaka"]],
        ["18 √∑ 3","6",["5","6","7","9"]],
        ["Planeta m√°s cercano al Sol","Mercurio",["Venus","Marte","Mercurio","J√∫piter"]],
        ["Ant√≥nimo de r√°pido","Lento",["Lento","√Ågil","Pronto","Breve"]],
        ["5 √ó 6","30",["25","30","35","20"]],
        ["Capital de M√©xico","Ciudad de M√©xico",["Guadalajara","Monterrey","Ciudad de M√©xico","Puebla"]],
        ["Oc√©ano m√°s grande","Pac√≠fico",["Atl√°ntico","√çndico","Pac√≠fico","√Årtico"]],
        ["Ra√≠z cuadrada de 81","9",["7","8","9","10"]],
        ["Sin√≥nimo de feliz","Contento",["Triste","Contento","Enojado","Cansado"]],
        ["Planeta rojo","Marte",["J√∫piter","Venus","Marte","Saturno"]],
        ["7 + 8","15",["14","15","16","17"]],
        ["Lenguaje usado para p√°ginas web","HTML",["Python","HTML","C++","Java"]],
        ["Capital de Francia","Par√≠s",["Roma","Madrid","Par√≠s","Berl√≠n"]],
        ["100 √∑ 4","25",["20","25","30","40"]],
        ["Animal m√°s grande del mundo","Ballena azul",["Elefante","Ballena azul","Tibur√≥n","Jirafa"]],
        ["Ant√≥nimo de oscuro","Claro",["Negro","Tenue","Claro","Sombr√≠o"]],
        ["6 √ó 9","54",["45","54","56","49"]],
        ["Gas que respiramos","Ox√≠geno",["Nitr√≥geno","Ox√≠geno","Hidr√≥geno","Helio"]],
        ["Capital de Italia","Roma",["Venecia","Mil√°n","Roma","N√°poles"]],
        ["50 + 25","75",["65","70","75","80"]],
        ["Estrella del sistema solar","Sol",["Luna","Sol","Marte","J√∫piter"]],
        ["Lenguaje de programaci√≥n para microcontroladores","C",["HTML","C","PHP","CSS"]],
        ["Capital de Espa√±a","Madrid",["Barcelona","Madrid","Sevilla","Valencia"]],
        ["9 √ó 8","72",["64","70","72","80"]],
        ["Ant√≥nimo de fr√≠o","Caliente",["Helado","Fresco","Caliente","Tibio"]],
        ["Instrumento para medir voltaje","Mult√≠metro",["Amper√≠metro","Mult√≠metro","Ohm√≠metro","Regla"]],
        ["Planeta con anillos","Saturno",["Marte","Saturno","Urano","Venus"]],
        ["60 √∑ 5","12",["10","11","12","15"]],
        ["Capital de Argentina","Buenos Aires",["C√≥rdoba","Rosario","Buenos Aires","La Plata"]],
        ["Sin√≥nimo de grande","Enorme",["Peque√±o","Corto","Enorme","Bajo"]],
        ["4¬≤","16",["8","12","16","20"]],
        ["Lenguaje usado en PIC BASIC PRO","BASIC",["C","BASIC","Python","Java"]],
        ["Capital de Brasil","Brasilia",["R√≠o de Janeiro","S√£o Paulo","Brasilia","Salvador"]],
        ["15 ‚àí 7","8",["6","7","8","9"]],
        ["Ant√≥nimo de alto","Bajo",["Grande","Bajo","Ancho","Largo"]],
        ["Unidad de resistencia el√©ctrica","Ohm",["Volt","Ampere","Ohm","Watt"]],
        ["Planeta m√°s grande","J√∫piter",["Saturno","Neptuno","J√∫piter","Urano"]],
        ["3 √ó 12","36",["30","32","36","40"]],
        ["Capital de Chile","Santiago",["Valpara√≠so","Concepci√≥n","Santiago","La Serena"]],
        ["Sin√≥nimo de r√°pido","Veloz",["Lento","Veloz","Pesado","Tarde"]],
        ["N√∫mero binario de 2","10",["01","10","11","100"]],
        ["Capital de Per√∫","Lima",["Cusco","Arequipa","Lima","Piura"]],
        ["8 + 12","20",["18","19","20","22"]],
        ["Ant√≥nimo de feliz","Triste",["Alegre","Triste","Contento","Animado"]],
        ["Dispositivo para mostrar texto","LCD",["LED","LCD","Sensor","Relay"]]
    ];
    let P=[];
    while(P.length<200){
        let q=base[Math.floor(Math.random()*base.length)];
        P.push({q:q[0],c:q[1],o:[...q[2]].sort(()=>Math.random()-.5)});
    }
    return P.sort(()=>Math.random()-.5);
}

/* üéÆ GAME */
class Game{
    constructor(){
        this.ui={
            menu:$("menu"),juego:$("juego"),final:$("final"),
            pausa:$("pausa"),nombre:$("nombre"),
            pregunta:$("pregunta"),puntos:$("puntos"),
            vidas:$("vidas"),tiempo:$("tiempo"),
            tabla:$("tabla"),mensajeFinal:$("mensajeFinal")
        };
        this.loadScores();
    }

    start(){
        beep(900,.1);
        this.paused=false;
        this.preguntas=generarPreguntas();
        this.p=0; this.v=3;
        this.ui.menu.style.display="none";
        this.ui.final.style.display="none";
        this.ui.juego.style.display="block";
        this.next();
    }

    next(){
        this.clear();
        this.actual=this.preguntas.pop();
        this.ui.pregunta.textContent=this.actual.q;

        let t=10;
        this.ui.tiempo.textContent=t;
        this.timer=setInterval(()=>{
            if(this.paused)return;
            t--;
            this.ui.tiempo.textContent=t;
            if(t===0)this.fail();
        },1000);

        this.actual.o.forEach(op=>this.spawnOption(op));
    }

    spawnOption(text){
        const e=document.createElement("div");
        e.className="opcion";
        e.textContent=text;
        e.onclick=()=>!this.paused&&this.check(text);
        document.body.appendChild(e);

        let x=Math.random()*(innerWidth-140);
        let y=innerHeight*0.6+Math.random()*180;
        let dx=(Math.random()*3+1)*(Math.random()<.5?-1:1);
        let dy=(Math.random()*3+1)*(Math.random()<.5?-1:1);

        e._m=setInterval(()=>{
            if(this.paused)return;
            x+=dx; y+=dy;
            if(x<0||x>innerWidth-140)dx*=-1;
            if(y<innerHeight*0.55||y>innerHeight-60)dy*=-1;
            e.style.left=x+"px";
            e.style.top=y+"px";
        },20);
    }

    check(r){
        clearInterval(this.timer);
        r===this.actual.c ? this.ok() : this.fail();
    }

    ok(){
        beep(1200,.1);
        this.p++;
        this.ui.puntos.textContent=this.p;
        this.next();
    }

    fail(){
        beep(200,.2);
        this.v--;
        this.ui.vidas.textContent=this.v;
        this.v<=0?this.end():this.next();
    }

    togglePause(){
        this.paused=!this.paused;
        this.ui.pausa.style.display=this.paused?"flex":"none";
    }

    clear(){
        document.querySelectorAll(".opcion").forEach(o=>{
            clearInterval(o._m);
            o.remove();
        });
    }

    end(){
        this.saveScore();
        this.ui.juego.style.display="none";
        this.ui.final.style.display="flex";
        this.ui.mensajeFinal.textContent=`FIN DEL JUEGO\nPUNTOS: ${this.p}`;
    }

    backToMenu(){
        this.clear();
        clearInterval(this.timer);
        this.paused=false;

        this.ui.juego.style.display="none";
        this.ui.final.style.display="none";
        this.ui.pausa.style.display="none";
        this.ui.menu.style.display="flex";

        this.ui.puntos.textContent="0";
        this.ui.vidas.textContent="3";
        this.ui.tiempo.textContent="10";
    }

    saveScore(){
        let d=JSON.parse(localStorage.getItem("scores"))||[];
        d.push({nombre:this.ui.nombre.value||"JUGADOR",puntos:this.p});
        d.sort((a,b)=>b.puntos-a.puntos);
        localStorage.setItem("scores",JSON.stringify(d.slice(0,5)));
        this.loadScores();
    }

    loadScores(){
        let d=JSON.parse(localStorage.getItem("scores"))||[];
        this.ui.tabla.innerHTML=d.length
            ? d.map((e,i)=>`${i+1}.- ${(e.nombre||"JUGADOR").substring(0,10)} - ${e.puntos}`).join("<br>")
            : "Sin r√©cords";
    }
}

const game=new Game();
</script>
</body>
</html>
